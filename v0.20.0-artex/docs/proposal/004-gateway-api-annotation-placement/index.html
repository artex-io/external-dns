
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="external-dns maintainers">
      
      
      
        <link rel="prev" href="../003-dnsendpoint-graduation-to-beta/">
      
      
        <link rel="next" href="../../advanced/configuration-precedence/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>004 gateway api annotation placement - external-dns</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#gateway-api-annotation-placement-clarity" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="external-dns" class="md-header__button md-logo" aria-label="external-dns" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            external-dns
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              004 gateway api annotation placement
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/kubernetes-sigs/external-dns/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    kubernetes-sigs/external-dns
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../charts/external-dns/" class="md-tabs__link">
          
  
  
    
  
  Chart

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../faq/" class="md-tabs__link">
          
  
  
    
  
  About

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tutorials/akamai-edgedns/" class="md-tabs__link">
          
  
  
    
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../annotations/annotations/" class="md-tabs__link">
          
  
  
    
  
  Annotations

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../sources/" class="md-tabs__link">
          
  
  
    
  
  Sources

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../registry/registry/" class="md-tabs__link">
          
  
  
    
  
  Registries

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../advanced/fqdn-templating/" class="md-tabs__link">
          
  
  
    
  
  Advanced Topics

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../CONTRIBUTING/" class="md-tabs__link">
          
  
  
    
  
  Contributing

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="external-dns" class="md-nav__button md-logo" aria-label="external-dns" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    external-dns
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/kubernetes-sigs/external-dns/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    kubernetes-sigs/external-dns
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../charts/external-dns/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Chart
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Chart
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../charts/external-dns/CHANGELOG/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    About
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Flags
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../20190708-external-dns-incubator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Out of Incubator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../code-of-conduct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code of Conduct
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../LICENSE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    License
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../providers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Providers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../version-update-playbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Version Update
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/akamai-edgedns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Akamai Edge DNS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/alibabacloud/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Alibaba Cloud
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/aws-filters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS Filters
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/aws-load-balancer-controller/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS Load Balancer Controller
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/aws-public-private-route53/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS Route53 with same domain for public and private zones
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/aws-sd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS Cloud Map API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/aws/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/azure-private-dns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure Private DNS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/azure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure DNS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/civo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Civo DNS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/cloudflare/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cloudflare DNS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/contour/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contour HTTPProxy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/coredns-etcd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CoreDNS with etcd backend
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/coredns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CoreDNS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/crd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Using CRD Source for DNS Records
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/digitalocean/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DigitalOcean DNS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/dnsimple/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DNSimple
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/exoscale/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Exoscale
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/externalname/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ExternalName Services
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/gandi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gandi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/gke-nginx/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GKE with nginx-ingress-controller
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/gke/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GKE with default controller
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/godaddy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GoDaddy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/hostport/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Headless Services
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/ionoscloud/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IONOS Cloud
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/kops-dns-controller/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kOps dns-controller
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/kube-ingress-aws/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kube-ingress-aws-controller
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/linode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linode
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/myra/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Myra ExternalDNS Webhook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/ns1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NS1
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/oracle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Oracle Cloud Infrastructure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/ovh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OVHcloud
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/pdns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PowerDNS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/pihole/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pi-hole
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/plural/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plural
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/rfc2136/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RFC2136 provider
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/scaleway/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scaleway
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/security-context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Running ExternalDNS with limited privileges
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/transip/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TransIP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/webhook-provider/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Webhook provider
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Annotations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Annotations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../annotations/annotations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../sources/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Sources
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Sources
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/crd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CRD Source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/f5-transportserver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    F5 Networks TransportServer Source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/f5-virtualserver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    F5 Networks VirtualServer Source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/gateway-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gateway API Route Sources
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/gateway/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gateway sources
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/gloo-proxy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gloo Proxy Source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/ingress/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ingress source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/istio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Istio Gateway / Virtual Service Source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/kong/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kong TCPIngress Source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/mx-record/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MX record with CRD source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/nodes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cluster Nodes as Source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/ns-record/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NS record with CRD source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/openshift/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OpenShift Route Source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/pod/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pod Source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/service/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Service source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/traefik-proxy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Traefik Proxy Source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/txt-record/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Creating TXT record with CRD source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Registries
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Registries
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../registry/registry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../registry/txt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TXT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../registry/dynamodb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DynamoDB
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Advanced Topics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced Topics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/fqdn-templating/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FQDN Templating
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/import-records/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Import Records
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../initial-design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Initial Design
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes Events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../001-leader-election/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Leader Election
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../monitoring/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Monitoring
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8_6" id="__nav_8_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Monitoring
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Available Metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multi-target/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MultiTarget
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/nat64/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NAT64
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/rate-limits/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rate Limits
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/ttl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TTL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_11" checked>
        
          
          <label class="md-nav__link" for="__nav_8_11" id="__nav_8_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Decisions
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_11_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Decisions
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../002-internal-ipv6-handling-rollback/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    002 internal ipv6 handling rollback
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../003-dnsendpoint-graduation-to-beta/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    003 dnsendpoint graduation to beta
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    004 gateway api annotation placement
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    004 gateway api annotation placement
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table of Contents
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#motivation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Motivation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Motivation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#current-implementation-behavior" class="md-nav__link">
    <span class="md-ellipsis">
      
        Current Implementation Behavior
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#goals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Goals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-goals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Non-Goals
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proposal" class="md-nav__link">
    <span class="md-ellipsis">
      
        Proposal
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Proposal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user-stories" class="md-nav__link">
    <span class="md-ellipsis">
      
        User Stories
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="User Stories">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#story-1-platform-engineer-with-cloudflare-5901" class="md-nav__link">
    <span class="md-ellipsis">
      
        Story 1: Platform Engineer with Cloudflare (#5901)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#story-2-user-attempting-route-specific-targets-4056" class="md-nav__link">
    <span class="md-ellipsis">
      
        Story 2: User Attempting Route-Specific Targets (#4056)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#current-behavior" class="md-nav__link">
    <span class="md-ellipsis">
      
        Current Behavior
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Current Behavior">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#annotation-placement-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Annotation Placement Matrix
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-references" class="md-nav__link">
    <span class="md-ellipsis">
      
        Code References
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proposed-solutions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Proposed Solutions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Proposed Solutions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solution-1-documentation-improvements-short-term-quick-win" class="md-nav__link">
    <span class="md-ellipsis">
      
        Solution 1: Documentation Improvements (Short-term - Quick Win)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-aws-route53-with-routing-policies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: AWS Route53 with Routing Policies
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-mistakes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common Mistakes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Mistakes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solution-2-annotation-inheritance-and-merging-long-term-feature-enhancement" class="md-nav__link">
    <span class="md-ellipsis">
      
        Solution 2: Annotation Inheritance and Merging (Long-term - Feature Enhancement)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drawbacks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Drawbacks
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Drawbacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#documentation-only-solution" class="md-nav__link">
    <span class="md-ellipsis">
      
        Documentation-Only Solution
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#annotation-merging-solution" class="md-nav__link">
    <span class="md-ellipsis">
      
        Annotation Merging Solution
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alternatives" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternatives
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Alternatives">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alternative-1-do-nothing-status-quo" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 1: Do Nothing (Status Quo)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-2-move-all-annotations-to-gateway-only" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 2: Move All Annotations to Gateway Only
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-3-support-annotations-on-both-with-strict-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 3: Support Annotations on Both with Strict Validation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-4-create-dedicated-gatewaydnsconfig-crd" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 4: Create Dedicated GatewayDNSConfig CRD
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-5-wait-for-annotation-standardization-pr-5080" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 5: Wait for Annotation Standardization (PR #5080)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommendation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommendation
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/configuration-precedence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration Precedence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/split-horizon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Split Horizon DNS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../contributing/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9" id="__nav_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Contributing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes Contributions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Release
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deprecation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Deprecation Policy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/chart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Helm Chart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Design
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/dev-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Developer Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/source-wrappers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
     Source Wrappers/Middleware
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/sources-and-providers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sources and Providers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table of Contents
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#motivation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Motivation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Motivation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#current-implementation-behavior" class="md-nav__link">
    <span class="md-ellipsis">
      
        Current Implementation Behavior
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#goals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Goals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-goals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Non-Goals
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proposal" class="md-nav__link">
    <span class="md-ellipsis">
      
        Proposal
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Proposal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user-stories" class="md-nav__link">
    <span class="md-ellipsis">
      
        User Stories
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="User Stories">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#story-1-platform-engineer-with-cloudflare-5901" class="md-nav__link">
    <span class="md-ellipsis">
      
        Story 1: Platform Engineer with Cloudflare (#5901)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#story-2-user-attempting-route-specific-targets-4056" class="md-nav__link">
    <span class="md-ellipsis">
      
        Story 2: User Attempting Route-Specific Targets (#4056)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#current-behavior" class="md-nav__link">
    <span class="md-ellipsis">
      
        Current Behavior
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Current Behavior">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#annotation-placement-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Annotation Placement Matrix
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-references" class="md-nav__link">
    <span class="md-ellipsis">
      
        Code References
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proposed-solutions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Proposed Solutions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Proposed Solutions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solution-1-documentation-improvements-short-term-quick-win" class="md-nav__link">
    <span class="md-ellipsis">
      
        Solution 1: Documentation Improvements (Short-term - Quick Win)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-aws-route53-with-routing-policies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: AWS Route53 with Routing Policies
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-mistakes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common Mistakes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Mistakes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solution-2-annotation-inheritance-and-merging-long-term-feature-enhancement" class="md-nav__link">
    <span class="md-ellipsis">
      
        Solution 2: Annotation Inheritance and Merging (Long-term - Feature Enhancement)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drawbacks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Drawbacks
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Drawbacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#documentation-only-solution" class="md-nav__link">
    <span class="md-ellipsis">
      
        Documentation-Only Solution
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#annotation-merging-solution" class="md-nav__link">
    <span class="md-ellipsis">
      
        Annotation Merging Solution
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alternatives" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternatives
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Alternatives">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alternative-1-do-nothing-status-quo" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 1: Do Nothing (Status Quo)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-2-move-all-annotations-to-gateway-only" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 2: Move All Annotations to Gateway Only
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-3-support-annotations-on-both-with-strict-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 3: Support Annotations on Both with Strict Validation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-4-create-dedicated-gatewaydnsconfig-crd" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 4: Create Dedicated GatewayDNSConfig CRD
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-5-wait-for-annotation-standardization-pr-5080" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 5: Wait for Annotation Standardization (PR #5080)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommendation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommendation
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nn">---</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Gateway</span><span class="nv"> </span><span class="s">API</span><span class="nv"> </span><span class="s">Annotation</span><span class="nv"> </span><span class="s">Placement</span><span class="nv"> </span><span class="s">Clarity&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1alpha1</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="nt">authors</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;@lexfrei&quot;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="nt">creation-date</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2025-10-23</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">provisional</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="nn">---</span>
</code></pre></div>
<h1 id="gateway-api-annotation-placement-clarity">Gateway API Annotation Placement Clarity<a class="headerlink" href="#gateway-api-annotation-placement-clarity" title="Permanent link">&para;</a></h1>
<h2 id="table-of-contents">Table of Contents<a class="headerlink" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<!-- toc -->
<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#motivation">Motivation</a><ul>
<li><a href="#goals">Goals</a></li>
<li><a href="#non-goals">Non-Goals</a></li>
</ul>
</li>
<li><a href="#proposal">Proposal</a><ul>
<li><a href="#user-stories">User Stories</a></li>
<li><a href="#current-behavior">Current Behavior</a></li>
<li><a href="#proposed-solutions">Proposed Solutions</a></li>
<li><a href="#drawbacks">Drawbacks</a></li>
</ul>
</li>
<li><a href="#alternatives">Alternatives</a></li>
</ul>
<!-- /toc -->

<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p>The <a href="https://kubernetes-sigs.github.io/external-dns/latest/docs/annotations/annotations/">annotations documentation</a><br />
indicates that Gateway API sources support various annotations, but it does not clearly specify which Kubernetes<br />
resource (Gateway vs HTTPRoute/GRPCRoute/TLSRoute/etc.) these annotations should be placed on. This ambiguity leads<br />
to user confusion and misconfigurations.</p>
<p>This proposal aims to:</p>
<ol>
<li><strong>Short-term</strong>: Improve documentation to explicitly clarify annotation placement</li>
<li><strong>Long-term</strong>: Consider implementing annotation inheritance from Gateway to Routes</li>
</ol>
<h2 id="motivation">Motivation<a class="headerlink" href="#motivation" title="Permanent link">&para;</a></h2>
<p>Users frequently misconfigure annotations when using Gateway API sources because the current documentation uses &ldquo;Gateway&rdquo; as the source name in the annotation support table, which is ambiguousit refers to gateway-api sources generically, not the Gateway resource specifically.</p>
<h3 id="current-implementation-behavior">Current Implementation Behavior<a class="headerlink" href="#current-implementation-behavior" title="Permanent link">&para;</a></h3>
<p>Based on the source code<br />
(<a href="https://github.com/kubernetes-sigs/external-dns/blob/master/source/gateway.go">source/gateway.go</a>):</p>
<p><strong>Gateway resource annotations:</strong></p>
<ul>
<li><code>external-dns.alpha.kubernetes.io/target</code> - read from Gateway<br />
  (<a href="https://github.com/kubernetes-sigs/external-dns/blob/master/source/gateway.go#L380">line ~380</a>)</li>
</ul>
<p><strong>Route resource annotations (HTTPRoute, GRPCRoute, TLSRoute, TCPRoute, UDPRoute):</strong></p>
<ul>
<li><code>external-dns.alpha.kubernetes.io/hostname</code> - read from Route</li>
<li><code>external-dns.alpha.kubernetes.io/ttl</code> - read from Route</li>
<li><code>external-dns.alpha.kubernetes.io/controller</code> - read from Route</li>
<li><strong>Provider-specific annotations</strong> (e.g., <code>cloudflare-proxied</code>, <code>aws/*</code>, <code>scw/*</code>, etc.) - read from Route<br />
  (<a href="https://github.com/kubernetes-sigs/external-dns/blob/master/source/gateway.go#L242">line ~242</a>)</li>
</ul>
<p>This separation aligns with Gateway API architecture:</p>
<ul>
<li><strong>Gateway</strong> = infrastructure layer (IP addresses, listeners, load balancers)</li>
<li><strong>Routes</strong> = application layer (DNS records, routing rules, hostnames)</li>
</ul>
<p>However, users expect provider-specific annotations to work on Gateway (similar to how <code>target</code> works), leading to silent failures.</p>
<h3 id="goals">Goals<a class="headerlink" href="#goals" title="Permanent link">&para;</a></h3>
<ul>
<li>Clarify annotation placement in documentation to prevent user confusion</li>
<li>Provide practical examples for common providers (Cloudflare, AWS, Scaleway)</li>
<li>Define a clear, documented contract for where each annotation type should be placed</li>
<li>Reduce support burden from repeated misconfigurations</li>
</ul>
<h3 id="non-goals">Non-Goals<a class="headerlink" href="#non-goals" title="Permanent link">&para;</a></h3>
<ul>
<li>This proposal does not address the broader annotation standardization effort discussed in <a href="https://github.com/kubernetes-sigs/external-dns/pull/5080">PR #5080</a></li>
<li>Redesigning the Gateway API source implementation</li>
<li>Changing behavior for non-Gateway sources (Ingress, Service, etc.)</li>
<li>Making breaking changes to existing Gateway API functionality</li>
</ul>
<h2 id="proposal">Proposal<a class="headerlink" href="#proposal" title="Permanent link">&para;</a></h2>
<h3 id="user-stories">User Stories<a class="headerlink" href="#user-stories" title="Permanent link">&para;</a></h3>
<h4 id="story-1-platform-engineer-with-cloudflare-5901">Story 1: Platform Engineer with Cloudflare (#5901)<a class="headerlink" href="#story-1-platform-engineer-with-cloudflare-5901" title="Permanent link">&para;</a></h4>
<p><em>As a platform engineer</em>, I set up a Gateway with the <code>external-dns.alpha.kubernetes.io/cloudflare-proxied: "true"</code><br />
annotation, expecting all DNS records for Routes using this Gateway to be proxied through Cloudflare. However, the<br />
annotation is silently ignored, and records are created without proxy, leading to unexpected traffic routing and<br />
security issues.</p>
<p><strong>Root cause</strong>: Had to dive into source code to discover that provider-specific annotations are only read from<br />
Route resources, not Gateway resources.</p>
<p><strong>Current workaround</strong>: Must copy the <code>cloudflare-proxied</code> annotation to every HTTPRoute manually.</p>
<h4 id="story-2-user-attempting-route-specific-targets-4056">Story 2: User Attempting Route-Specific Targets (#4056)<a class="headerlink" href="#story-2-user-attempting-route-specific-targets-4056" title="Permanent link">&para;</a></h4>
<p><em>As a user</em>, I want to specify different target DNS records for specific hosts while sharing a common Gateway. I<br />
added <code>external-dns.alpha.kubernetes.io/target</code> annotation on HTTPRoute to override the Gateway&rsquo;s target for one<br />
specific host, but it doesn&rsquo;t work - the annotation is ignored on HTTPRoute.</p>
<p><strong>Root cause</strong>: The <code>target</code> annotation must be on the Gateway resource, not on Route resources. There&rsquo;s no way to<br />
override targets on a per-Route basis.</p>
<p><strong>Outcome</strong>: User had to find alternative workarounds to exclude specific hosts or create separate Gateway resources.</p>
<h3 id="current-behavior">Current Behavior<a class="headerlink" href="#current-behavior" title="Permanent link">&para;</a></h3>
<h4 id="annotation-placement-matrix">Annotation Placement Matrix<a class="headerlink" href="#annotation-placement-matrix" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Annotation Type</th>
<th>Gateway Resource</th>
<th>Route Resources (HTTPRoute, GRPCRoute, etc.)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>target</code></td>
<td> <strong>Read from Gateway</strong></td>
<td>L Ignored</td>
</tr>
<tr>
<td><code>hostname</code></td>
<td>L Not used</td>
<td> <strong>Read from Route</strong></td>
</tr>
<tr>
<td><code>ttl</code></td>
<td>L Not used</td>
<td> <strong>Read from Route</strong></td>
</tr>
<tr>
<td><code>controller</code></td>
<td>L Not used</td>
<td> <strong>Read from Route</strong></td>
</tr>
<tr>
<td>Provider-specific (<code>cloudflare-proxied</code>, <code>aws/*</code>, <code>scw/*</code>)</td>
<td>L Not used</td>
<td> <strong>Read from Route</strong></td>
</tr>
</tbody>
</table>
<h4 id="code-references">Code References<a class="headerlink" href="#code-references" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1">// source/gateway.go line ~380</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="c1">// Target annotation is read from Gateway</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="nx">override</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">annotations</span><span class="p">.</span><span class="nx">TargetsFromTargetAnnotation</span><span class="p">(</span><span class="nx">gw</span><span class="p">.</span><span class="nx">gateway</span><span class="p">.</span><span class="nx">Annotations</span><span class="p">)</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="c1">// source/gateway.go line ~242</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="c1">// Provider-specific annotations are read from Route</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="nx">providerSpecific</span><span class="p">,</span><span class="w"> </span><span class="nx">setIdentifier</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">annotations</span><span class="p">.</span><span class="nx">ProviderSpecificAnnotations</span><span class="p">(</span><span class="nx">annots</span><span class="p">)</span>
</code></pre></div>
<p>Where <code>annots</code> is derived from the Route&rsquo;s metadata (<code>meta.Annotations</code>), not the Gateway.</p>
<h3 id="proposed-solutions">Proposed Solutions<a class="headerlink" href="#proposed-solutions" title="Permanent link">&para;</a></h3>
<h4 id="solution-1-documentation-improvements-short-term-quick-win">Solution 1: Documentation Improvements (Short-term - Quick Win)<a class="headerlink" href="#solution-1-documentation-improvements-short-term-quick-win" title="Permanent link">&para;</a></h4>
<p><strong>Implementation Status</strong>: Documentation improvements proposed in <a href="https://github.com/kubernetes-sigs/external-dns/pull/5918">PR #5918</a>.</p>
<p><strong>Note</strong>: If Solution 2 (Annotation Merging) is implemented, the documentation from PR #5918 will require updates<br />
to reflect the new inheritance behavior.</p>
<p><strong>Changes to <code>docs/annotations/annotations.md</code>:</strong></p>
<p>Expand footnote [^4] or add a new section &ldquo;Gateway API Annotation Placement&rdquo; with a detailed table:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="gu">### Gateway API Annotation Placement</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>When using Gateway API sources (gateway-httproute, gateway-grpcroute, etc.), annotations must be placed on specific resources:
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>| Annotation | Placement | Example Resource |
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>|------------|-----------|------------------|
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>| <span class="sb">`target`</span> | Gateway | <span class="sb">`kind: Gateway`</span> |
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>| <span class="sb">`hostname`</span> | Route | <span class="sb">`kind: HTTPRoute`</span>, <span class="sb">`kind: GRPCRoute`</span>, etc. |
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>| <span class="sb">`ttl`</span> | Route | <span class="sb">`kind: HTTPRoute`</span>, <span class="sb">`kind: GRPCRoute`</span>, etc. |
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>| <span class="sb">`controller`</span> | Route | <span class="sb">`kind: HTTPRoute`</span>, <span class="sb">`kind: GRPCRoute`</span>, etc. |
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>| <span class="sb">`cloudflare-proxied`</span> | Route | <span class="sb">`kind: HTTPRoute`</span>, <span class="sb">`kind: GRPCRoute`</span>, etc. |
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>| <span class="sb">`aws-*`</span> (all AWS annotations) | Route | <span class="sb">`kind: HTTPRoute`</span>, <span class="sb">`kind: GRPCRoute`</span>, etc. |
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>| <span class="sb">`scw-*`</span> (all Scaleway annotations) | Route | <span class="sb">`kind: HTTPRoute`</span>, <span class="sb">`kind: GRPCRoute`</span>, etc. |
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="gs">**Rationale**</span>: The Gateway resource defines infrastructure (IP addresses, listeners), while Routes define application-level DNS records. Therefore, DNS record properties (TTL, provider settings) are configured on Routes.
</code></pre></div>
<p><strong>Changes to <code>docs/sources/gateway-api.md</code>:</strong></p>
<p>Add a new section after &ldquo;Hostnames&rdquo;:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="gu">## Annotations</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="gu">### Annotation Placement</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>ExternalDNS reads different annotations from different Gateway API resources:
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="k">-</span><span class="w"> </span><span class="gs">**Gateway annotations**</span>: Only <span class="sb">`external-dns.alpha.kubernetes.io/target`</span> is read from Gateway resources
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="k">-</span><span class="w"> </span><span class="gs">**Route annotations**</span>: All other annotations (hostname, ttl, provider-specific) are read from Route resources
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="gu">#### Example: Cloudflare Proxied Records</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>```yaml
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>apiVersion: gateway.networking.k8s.io/v1
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>kind: Gateway
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>metadata:
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>  name: my-gateway
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>  namespace: default
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>  annotations:
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>    #  Correct: target annotation on Gateway
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>    external-dns.alpha.kubernetes.io/target: &quot;203.0.113.1&quot;
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>spec:
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>  gatewayClassName: cilium
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>  listeners:
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a><span class="w">    </span><span class="k">-</span><span class="w"> </span>name: https
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>      hostname: &quot;*.example.com&quot;
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>      protocol: HTTPS
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="gu">      port: 443</span>
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a><span class="gu">---</span>
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a>apiVersion: gateway.networking.k8s.io/v1
<a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a>kind: HTTPRoute
<a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a>metadata:
<a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a>  name: my-route
<a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a>  annotations:
<a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a>    #  Correct: provider-specific annotations on HTTPRoute
<a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a>    external-dns.alpha.kubernetes.io/cloudflare-proxied: &quot;true&quot;
<a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a>    external-dns.alpha.kubernetes.io/ttl: &quot;300&quot;
<a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a>spec:
<a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a>  parentRefs:
<a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a><span class="w">    </span><span class="k">-</span><span class="w"> </span>name: my-gateway
<a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a>      namespace: default
<a id="__codelineno-3-41" name="__codelineno-3-41" href="#__codelineno-3-41"></a>  hostnames:
<a id="__codelineno-3-42" name="__codelineno-3-42" href="#__codelineno-3-42"></a><span class="w">    </span><span class="k">-</span><span class="w"> </span>api.example.com
<a id="__codelineno-3-43" name="__codelineno-3-43" href="#__codelineno-3-43"></a>  rules:
<a id="__codelineno-3-44" name="__codelineno-3-44" href="#__codelineno-3-44"></a><span class="w">    </span><span class="k">-</span><span class="w"> </span>backendRefs:
<a id="__codelineno-3-45" name="__codelineno-3-45" href="#__codelineno-3-45"></a><span class="w">        </span><span class="k">-</span><span class="w"> </span>name: api-service
<a id="__codelineno-3-46" name="__codelineno-3-46" href="#__codelineno-3-46"></a>          port: 8080
</code></pre></div>
<h4 id="example-aws-route53-with-routing-policies">Example: AWS Route53 with Routing Policies<a class="headerlink" href="#example-aws-route53-with-routing-policies" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gateway.networking.k8s.io/v1</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Gateway</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aws-gateway</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">    </span><span class="c1">#  Correct: target annotation on Gateway</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">    </span><span class="nt">external-dns.alpha.kubernetes.io/target</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;alb-123.us-east-1.elb.amazonaws.com&quot;</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="nn">---</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gateway.networking.k8s.io/v1</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HTTPRoute</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">weighted-route</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="w">    </span><span class="c1">#  Correct: AWS-specific annotations on HTTPRoute</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="w">    </span><span class="nt">external-dns.alpha.kubernetes.io/aws-weight</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;100&quot;</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="w">    </span><span class="nt">external-dns.alpha.kubernetes.io/set-identifier</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;backend-v1&quot;</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="w">  </span><span class="nt">parentRefs</span><span class="p">:</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aws-gateway</span>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="w">  </span><span class="nt">hostnames</span><span class="p">:</span>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app.example.com</span>
</code></pre></div>
<h3 id="common-mistakes">Common Mistakes<a class="headerlink" href="#common-mistakes" title="Permanent link">&para;</a></h3>
<p> <strong>Incorrect</strong>: Placing provider-specific annotations on Gateway</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Gateway</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">    </span><span class="nt">external-dns.alpha.kubernetes.io/cloudflare-proxied</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="w">  </span><span class="c1">#  Ignored</span>
</code></pre></div>
<p> <strong>Incorrect</strong>: Placing target annotation on HTTPRoute</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HTTPRoute</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">    </span><span class="nt">external-dns.alpha.kubernetes.io/target</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;203.0.113.1&quot;</span><span class="w">  </span><span class="c1">#  Ignored</span>
</code></pre></div>
<p><strong>Implementation effort</strong>: Low<br />
<strong>Maintenance burden</strong>: Minimal (documentation only)<br />
<strong>User benefit</strong>: Immediate clarity, reduced misconfiguration</p>
<h4 id="solution-2-annotation-inheritance-and-merging-long-term-feature-enhancement">Solution 2: Annotation Inheritance and Merging (Long-term - Feature Enhancement)<a class="headerlink" href="#solution-2-annotation-inheritance-and-merging-long-term-feature-enhancement" title="Permanent link">&para;</a></h4>
<p><strong>Reference Implementation</strong>: <a href="https://github.com/kubernetes-sigs/external-dns/pull/5998">PR #5998</a></p>
<p>Implement annotation merging logic where:</p>
<ol>
<li>Gateway annotations serve as <strong>defaults</strong> for all Routes attached to that Gateway</li>
<li>Route annotations <strong>override</strong> Gateway annotations for specific Routes</li>
<li><strong>All annotations are inheritable</strong>, including <code>target</code>  enabling per-Route target overrides</li>
</ol>
<p><strong>Proposed implementation</strong> (pseudocode):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1">// source/gateway.go - proposed changes</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">src</span><span class="w"> </span><span class="o">*</span><span class="nx">gatewayRouteSource</span><span class="p">)</span><span class="w"> </span><span class="nx">Endpoints</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="o">*</span><span class="nx">endpoint</span><span class="p">.</span><span class="nx">Endpoint</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">    </span><span class="c1">// ... existing code ...</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">route</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">routes</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">        </span><span class="c1">// Merge Gateway and Route annotations</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">        </span><span class="c1">// Route annotations take precedence over Gateway annotations</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">        </span><span class="nx">gwAnnots</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">gw</span><span class="p">.</span><span class="nx">gateway</span><span class="p">.</span><span class="nx">Annotations</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">        </span><span class="nx">rtAnnots</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">route</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">Annotations</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">        </span><span class="nx">mergedAnnots</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">mergeAnnotations</span><span class="p">(</span><span class="nx">gwAnnots</span><span class="p">,</span><span class="w"> </span><span class="nx">rtAnnots</span><span class="p">)</span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">        </span><span class="c1">// Use merged annotations for all annotation processing</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="w">        </span><span class="nx">providerSpecific</span><span class="p">,</span><span class="w"> </span><span class="nx">setIdentifier</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">annotations</span><span class="p">.</span><span class="nx">ProviderSpecificAnnotations</span><span class="p">(</span><span class="nx">mergedAnnots</span><span class="p">)</span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="w">        </span><span class="nx">ttl</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">annotations</span><span class="p">.</span><span class="nx">TTLFromAnnotations</span><span class="p">(</span><span class="nx">mergedAnnots</span><span class="p">,</span><span class="w"> </span><span class="nx">resource</span><span class="p">)</span>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="w">        </span><span class="c1">// ... rest of endpoint creation ...</span>
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="p">}</span>
<a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a>
<a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="c1">// Helper function</span>
<a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="kd">func</span><span class="w"> </span><span class="nx">mergeAnnotations</span><span class="p">(</span><span class="nx">gateway</span><span class="p">,</span><span class="w"> </span><span class="nx">route</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="w">    </span><span class="nx">merged</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nx">gateway</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="nx">route</span><span class="p">))</span>
<a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a>
<a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a><span class="w">    </span><span class="c1">// Copy Gateway annotations (defaults)</span>
<a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">k</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">gateway</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a><span class="w">        </span><span class="nx">merged</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">v</span>
<a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a>
<a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a><span class="w">    </span><span class="c1">// Route annotations override Gateway defaults</span>
<a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">k</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">route</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a><span class="w">        </span><span class="nx">merged</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">v</span>
<a id="__codelineno-7-32" name="__codelineno-7-32" href="#__codelineno-7-32"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-7-33" name="__codelineno-7-33" href="#__codelineno-7-33"></a>
<a id="__codelineno-7-34" name="__codelineno-7-34" href="#__codelineno-7-34"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">merged</span>
<a id="__codelineno-7-35" name="__codelineno-7-35" href="#__codelineno-7-35"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Example use case enabled by this approach:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gateway.networking.k8s.io/v1</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Gateway</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">intranet-gateway</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">    </span><span class="c1"># Default target for internal services</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">    </span><span class="nt">external-dns.alpha.kubernetes.io/target</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;172.16.6.6&quot;</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w">    </span><span class="c1"># Set default for all Routes using this Gateway</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="w">    </span><span class="nt">external-dns.alpha.kubernetes.io/cloudflare-proxied</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;true&quot;</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="w">    </span><span class="nt">external-dns.alpha.kubernetes.io/ttl</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;300&quot;</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="nn">---</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gateway.networking.k8s.io/v1</span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HTTPRoute</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">internal-api</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="w">  </span><span class="c1"># Inherits: target=172.16.6.6, cloudflare-proxied=true, ttl=300 from Gateway</span>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="w">  </span><span class="nt">parentRefs</span><span class="p">:</span>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">intranet-gateway</span>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="w">  </span><span class="nt">hostnames</span><span class="p">:</span>
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api.internal.example.com</span>
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="nn">---</span>
<a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gateway.networking.k8s.io/v1</span>
<a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HTTPRoute</span>
<a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">public-api</span>
<a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a><span class="w">    </span><span class="c1"># Override: expose this route to the public internet</span>
<a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a><span class="w">    </span><span class="nt">external-dns.alpha.kubernetes.io/target</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;203.0.113.1&quot;</span>
<a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a><span class="w">    </span><span class="c1"># Inherits: cloudflare-proxied=true, ttl=300 from Gateway</span>
<a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a><span class="w">  </span><span class="nt">parentRefs</span><span class="p">:</span>
<a id="__codelineno-8-33" name="__codelineno-8-33" href="#__codelineno-8-33"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">intranet-gateway</span>
<a id="__codelineno-8-34" name="__codelineno-8-34" href="#__codelineno-8-34"></a><span class="w">  </span><span class="nt">hostnames</span><span class="p">:</span>
<a id="__codelineno-8-35" name="__codelineno-8-35" href="#__codelineno-8-35"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api.example.com</span>
<a id="__codelineno-8-36" name="__codelineno-8-36" href="#__codelineno-8-36"></a><span class="nn">---</span>
<a id="__codelineno-8-37" name="__codelineno-8-37" href="#__codelineno-8-37"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gateway.networking.k8s.io/v1</span>
<a id="__codelineno-8-38" name="__codelineno-8-38" href="#__codelineno-8-38"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HTTPRoute</span>
<a id="__codelineno-8-39" name="__codelineno-8-39" href="#__codelineno-8-39"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-8-40" name="__codelineno-8-40" href="#__codelineno-8-40"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">static-assets</span>
<a id="__codelineno-8-41" name="__codelineno-8-41" href="#__codelineno-8-41"></a><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<a id="__codelineno-8-42" name="__codelineno-8-42" href="#__codelineno-8-42"></a><span class="w">    </span><span class="c1"># Override: disable proxying for static content</span>
<a id="__codelineno-8-43" name="__codelineno-8-43" href="#__codelineno-8-43"></a><span class="w">    </span><span class="nt">external-dns.alpha.kubernetes.io/cloudflare-proxied</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;false&quot;</span>
<a id="__codelineno-8-44" name="__codelineno-8-44" href="#__codelineno-8-44"></a><span class="w">    </span><span class="c1"># Inherits: target=172.16.6.6, ttl=300 from Gateway</span>
<a id="__codelineno-8-45" name="__codelineno-8-45" href="#__codelineno-8-45"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-8-46" name="__codelineno-8-46" href="#__codelineno-8-46"></a><span class="w">  </span><span class="nt">parentRefs</span><span class="p">:</span>
<a id="__codelineno-8-47" name="__codelineno-8-47" href="#__codelineno-8-47"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">intranet-gateway</span>
<a id="__codelineno-8-48" name="__codelineno-8-48" href="#__codelineno-8-48"></a><span class="w">  </span><span class="nt">hostnames</span><span class="p">:</span>
<a id="__codelineno-8-49" name="__codelineno-8-49" href="#__codelineno-8-49"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">static.internal.example.com</span>
</code></pre></div>
<p>This example demonstrates a common use case: an intranet Gateway where most services are internal<br />
(<code>172.16.6.6</code>), but specific Routes can be exposed publicly (<code>203.0.113.1</code>) by overriding the<br />
<code>target</code> annotation.</p>
<p><strong>Benefits:</strong></p>
<ul>
<li>Reduces configuration duplication</li>
<li>Enables centralized defaults at Gateway level</li>
<li>Maintains flexibility with Route-level overrides</li>
<li>Better matches user mental model (infrastructure defaults + application overrides)</li>
<li><strong>Solves User Story 2</strong>: Enables per-Route target overrides without creating separate Gateways</li>
</ul>
<p><strong>Risks:</strong></p>
<ul>
<li>Backward compatibility concerns (may change behavior for existing users)</li>
<li>Increased code complexity</li>
<li>Potential for confusion about precedence rules</li>
<li>Need for comprehensive testing across all Gateway API Route types</li>
</ul>
<p><strong>Mitigation strategies:</strong></p>
<ul>
<li>Feature flag to opt-in to new behavior initially</li>
<li>Clear documentation of precedence rules</li>
<li>Extensive test coverage</li>
<li>Migration guide for users</li>
</ul>
<p><strong>Implementation effort</strong>: Medium<br />
<strong>Maintenance burden</strong>: Medium (code + tests + docs)<br />
<strong>User benefit</strong>: Significant reduction in configuration overhead</p>
<h3 id="drawbacks">Drawbacks<a class="headerlink" href="#drawbacks" title="Permanent link">&para;</a></h3>
<h4 id="documentation-only-solution">Documentation-Only Solution<a class="headerlink" href="#documentation-only-solution" title="Permanent link">&para;</a></h4>
<ul>
<li>Does not address the underlying UX issue (annotation duplication)</li>
<li>Requires users to manually propagate settings across Routes</li>
<li>Still allows silent failures if users misplace annotations</li>
</ul>
<h4 id="annotation-merging-solution">Annotation Merging Solution<a class="headerlink" href="#annotation-merging-solution" title="Permanent link">&para;</a></h4>
<ul>
<li>Adds complexity to the codebase</li>
<li>Requires careful consideration of precedence rules</li>
<li>May introduce unexpected behavior changes for existing users</li>
<li>Needs comprehensive testing for edge cases (multiple Gateways, cross-namespace, etc.)</li>
<li>Potential performance impact from annotation merging on every reconciliation</li>
</ul>
<h2 id="alternatives">Alternatives<a class="headerlink" href="#alternatives" title="Permanent link">&para;</a></h2>
<h3 id="alternative-1-do-nothing-status-quo">Alternative 1: Do Nothing (Status Quo)<a class="headerlink" href="#alternative-1-do-nothing-status-quo" title="Permanent link">&para;</a></h3>
<p><strong>Description</strong>: Keep current behavior and documentation as-is.</p>
<p><strong>Pros</strong>:</p>
<ul>
<li>No implementation effort required</li>
<li>No risk of introducing new bugs</li>
<li>No breaking changes</li>
</ul>
<p><strong>Cons</strong>:</p>
<ul>
<li>Users continue to experience confusion and misconfigurations</li>
<li>Increased support burden on maintainers and community</li>
<li>Poor user experience compared to other sources (Ingress supports annotations more intuitively)</li>
</ul>
<p><strong>Recommendation</strong>: L Not recommended - problem is well-documented and affects user productivity</p>
<h3 id="alternative-2-move-all-annotations-to-gateway-only">Alternative 2: Move All Annotations to Gateway Only<a class="headerlink" href="#alternative-2-move-all-annotations-to-gateway-only" title="Permanent link">&para;</a></h3>
<p><strong>Description</strong>: Refactor source code to read all annotations from Gateway, not Routes.</p>
<p><strong>Pros</strong>:</p>
<ul>
<li>Simplified mental model (one place for all annotations)</li>
<li>Centralized configuration</li>
</ul>
<p><strong>Cons</strong>:</p>
<ul>
<li><strong>Breaks Gateway API architecture</strong> - Routes define application-layer DNS records, so DNS properties belong on Routes</li>
<li>Cannot have different settings per Route (e.g., different TTLs for api.example.com vs static.example.com)</li>
<li>Loses flexibility that Route-level annotations provide</li>
<li>Requires breaking change to existing implementations</li>
</ul>
<p><strong>Recommendation</strong>: L Not recommended - violates Gateway API design principles</p>
<h3 id="alternative-3-support-annotations-on-both-with-strict-validation">Alternative 3: Support Annotations on Both with Strict Validation<a class="headerlink" href="#alternative-3-support-annotations-on-both-with-strict-validation" title="Permanent link">&para;</a></h3>
<p><strong>Description</strong>: Allow annotations on both Gateway and Route, but error/warn if duplicates exist without clear precedence.</p>
<p><strong>Pros</strong>:</p>
<ul>
<li>Provides flexibility</li>
<li>Catches configuration errors explicitly</li>
</ul>
<p><strong>Cons</strong>:</p>
<ul>
<li>Confusing for users (two valid places to configure)</li>
<li>Requires complex validation logic</li>
<li>Still doesn&rsquo;t solve the &ldquo;defaults + overrides&rdquo; use case</li>
<li>More complex to document and support</li>
</ul>
<p><strong>Recommendation</strong>:  Possible but adds complexity without solving core UX issue</p>
<h3 id="alternative-4-create-dedicated-gatewaydnsconfig-crd">Alternative 4: Create Dedicated GatewayDNSConfig CRD<a class="headerlink" href="#alternative-4-create-dedicated-gatewaydnsconfig-crd" title="Permanent link">&para;</a></h3>
<p><strong>Description</strong>: Introduce a new CRD that defines DNS configuration separately from Gateway and Route resources.</p>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">externaldns.k8s.io/v1alpha1</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GatewayDNSConfig</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cloudflare-defaults</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">  </span><span class="nt">gatewayRef</span><span class="p">:</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-gateway</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">  </span><span class="nt">defaults</span><span class="p">:</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="w">    </span><span class="nt">ttl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">300</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">    </span><span class="nt">providerSpecific</span><span class="p">:</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cloudflare-proxied</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;true&quot;</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="nn">---</span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">externaldns.k8s.io/v1alpha1</span>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RouteDNSConfig</span>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api-route-dns</span>
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="w">  </span><span class="nt">routeRef</span><span class="p">:</span>
<a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a><span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HTTPRoute</span>
<a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api-route</span>
<a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="w">  </span><span class="nt">overrides</span><span class="p">:</span>
<a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a><span class="w">    </span><span class="nt">ttl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span><span class="w">  </span><span class="c1"># Override Gateway default</span>
</code></pre></div>
<p><strong>Pros</strong>:</p>
<ul>
<li>Clean separation of concerns</li>
<li>Clear precedence model</li>
<li>No annotations needed (type-safe CRDs)</li>
<li>Aligns with Kubernetes resource composition patterns</li>
</ul>
<p><strong>Cons</strong>:</p>
<ul>
<li><strong>Significant implementation effort</strong> (new CRDs, controllers, validation, etc.)</li>
<li>Adds complexity with additional resources to manage</li>
<li>Requires migration from annotation-based approach</li>
<li>Diverges from how other sources work (Ingress, Service use annotations)</li>
<li>May conflict with future annotation standardization efforts</li>
</ul>
<p><strong>Recommendation</strong>:  Potentially valuable long-term, but scope is too large for this specific issue</p>
<h3 id="alternative-5-wait-for-annotation-standardization-pr-5080">Alternative 5: Wait for Annotation Standardization (PR #5080)<a class="headerlink" href="#alternative-5-wait-for-annotation-standardization-pr-5080" title="Permanent link">&para;</a></h3>
<p><strong>Description</strong>: Defer this work until the broader annotation standardization effort is resolved.</p>
<p><strong>Pros</strong>:</p>
<ul>
<li>Avoids potentially redundant work</li>
<li>May be addressed as part of larger effort</li>
</ul>
<p><strong>Cons</strong>:</p>
<ul>
<li>PR #5080 is not yet ready for review and timeline is uncertain</li>
<li>Users continue to experience issues in the meantime</li>
<li>Documentation improvements are still valuable regardless of standardization outcome</li>
</ul>
<p><strong>Recommendation</strong>:  Partial - implement documentation improvements now (Solution 1), reconsider<br />
annotation merging after standardization is resolved</p>
<h2 id="recommendation">Recommendation<a class="headerlink" href="#recommendation" title="Permanent link">&para;</a></h2>
<p><strong>Phased approach</strong>:</p>
<ol>
<li>
<p><strong>Immediate (v0.15.0 or next minor)</strong>: Implement Solution 1 (Documentation Improvements)</p>
<ul>
<li>Low risk, high user value</li>
<li>Can be merged quickly</li>
<li>Addresses immediate pain points</li>
</ul>
</li>
<li>
<p><strong>Near-term</strong>: Review and merge Solution 2 (Annotation Merging)</p>
<ul>
<li>Reference implementation available: <a href="https://github.com/kubernetes-sigs/external-dns/pull/5998">PR #5998</a></li>
<li>Includes comprehensive test coverage</li>
<li>Backward compatible (no breaking changes for existing configurations)</li>
<li>Solves User Story 2 (per-Route target overrides)</li>
</ul>
</li>
<li>
<p><strong>Future (post-PR #5080 resolution)</strong>: Re-evaluate if additional changes are needed</p>
<ul>
<li>Assess compatibility with annotation standardization outcomes</li>
<li>Gather user feedback on the annotation inheritance behavior</li>
</ul>
</li>
</ol>
<p>This approach provides immediate relief while keeping options open for more comprehensive solutions in the future.</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="December 27, 2025 16:20:32 UTC">December 27, 2025</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Copyright and theme information -->
<div class="md-copyright">
  
  
    Made with
    <a
      href="https://squidfunk.github.io/mkdocs-material/"
      target="_blank" rel="noopener"
    >
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["content.code.annotate", "navigation.top", "navigation.tracking", "navigation.indexes", "navigation.instant", "navigation.tabs", "navigation.tabs.sticky"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>